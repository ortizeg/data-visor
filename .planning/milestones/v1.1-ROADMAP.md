# Milestone v1.1: Deployment, Workflow & Competitive Parity

**Status:** SHIPPED 2026-02-13
**Phases:** 8-14
**Total Plans:** 20

## Overview

Make DataVisor deployable (Docker + GCP), secure for cloud access, and close key workflow gaps vs FiftyOne/Encord -- smart ingestion, annotation editing, error triage, interactive visualizations, and keyboard-driven navigation.

## Phases

### Phase 8: Docker Deployment & Auth

**Goal**: DataVisor runs as a deployable Docker stack with single-user auth, accessible securely on a cloud VM or locally with a single command
**Depends on**: Phase 7 (v1.0 complete)
**Requirements**: DEPLOY-01, DEPLOY-02, DEPLOY-03, DEPLOY-04, DEPLOY-05
**Plans**: 5 plans

Plans:
- [x] 08-01: Backend Dockerfile + config fixes (CORS, DuckDB CHECKPOINT)
- [x] 08-02: Frontend Dockerfile + Caddyfile reverse proxy with auth
- [x] 08-03: Docker Compose orchestration + .dockerignore + env config
- [x] 08-04: Local run script + GCP deployment scripts
- [x] 08-05: Deployment documentation + full stack verification

### Phase 9: Smart Ingestion

**Goal**: Users can import datasets from the UI by pointing at a folder, reviewing auto-detected structure, and confirming import -- no CLI or config files needed
**Depends on**: Phase 8 (auth protects new endpoints)
**Requirements**: INGEST-01, INGEST-02, INGEST-03, INGEST-04, INGEST-05
**Plans**: 2 plans

Plans:
- [x] 09-01: Backend FolderScanner service, scan/import API endpoints, split-aware ingestion pipeline
- [x] 09-02: Frontend ingestion wizard (path input, scan results, import progress) + landing page link

### Phase 10: Annotation Editing

**Goal**: Users can make quick bounding box corrections directly in the sample detail modal without leaving DataVisor
**Depends on**: Phase 8 (auth protects mutation endpoints)
**Requirements**: ANNOT-01, ANNOT-02, ANNOT-03, ANNOT-04, ANNOT-05
**Plans**: 3 plans

Plans:
- [x] 10-01: Backend annotation CRUD endpoints + frontend mutation hooks and types
- [x] 10-02: Konva building blocks: coord-utils, EditableRect, DrawLayer, ClassPicker
- [x] 10-03: AnnotationEditor composition, sample modal integration, annotation list delete

### Phase 11: Error Triage

**Goal**: Users can systematically review and tag errors with a focused triage workflow that persists decisions and surfaces the worst samples first
**Depends on**: Phase 8 (extends v1.0 error analysis)
**Requirements**: TRIAGE-01, TRIAGE-02, TRIAGE-03
**Plans**: 2 plans

Plans:
- [x] 11-01: Backend triage endpoints (set-triage-tag, worst-images scoring) + frontend hooks and types
- [x] 11-02: Triage tag buttons in detail modal, highlight mode grid dimming, worst-images stats panel

### Phase 12: Interactive Viz & Discovery

**Goal**: Users can explore dataset quality interactively -- clicking visualization elements filters the grid, finding similar samples and near-duplicates is one click away
**Depends on**: Phase 11 (triage data informs confusion matrix), Phase 8 (auth protects endpoints)
**Requirements**: ANNOT-06, TRIAGE-04, TRIAGE-05, TRIAGE-06
**Plans**: 3 plans

Plans:
- [x] 12-01: Discovery filter foundation + Find Similar grid filtering + interactive histogram bars
- [x] 12-02: Clickable confusion matrix cells with backend sample ID resolution
- [x] 12-03: Near-duplicate detection via Qdrant pairwise search with SSE progress

### Phase 13: Keyboard Shortcuts

**Goal**: Power users can navigate, triage, and edit entirely from the keyboard without reaching for the mouse
**Depends on**: Phase 10 (annotation edit shortcuts), Phase 11 (triage shortcuts), Phase 12 (all UI features exist)
**Requirements**: UX-01, UX-02, UX-03, UX-04
**Plans**: 2 plans

Plans:
- [x] 13-01: Foundation (react-hotkeys-hook, shortcut registry, ui-store) + grid keyboard navigation
- [x] 13-02: Modal shortcuts (navigation, triage, editing, undo) + help overlay

### Phase 14: Per-Annotation Triage

**Goal**: Users can see auto-discovered TP/FP/FN classifications per bounding box based on IoU overlap, with color-coded visualization in the detail modal and the ability to click individual annotations to override their classification
**Depends on**: Phase 11 (extends triage system), Phase 6 (error analysis IoU matching)
**Plans**: 3 plans

Plans:
- [x] 14-01: Backend schema, IoU matching service, and annotation triage API endpoints
- [x] 14-02: Frontend types, hooks, and clickable TriageOverlay SVG component
- [x] 14-03: Wire TriageOverlay into sample modal + highlight mode integration

## Milestone Summary

**Key Decisions:**

- Caddy over nginx for reverse proxy (auto-HTTPS, built-in basic_auth)
- CPU-only PyTorch via post-sync replacement in Dockerfile
- react-konva for annotation editing (SVG stays for grid overlays)
- FastAPI HTTPBasic DI over middleware (testable, composable)
- Atomic triage tag replacement via list_filter + list_append single SQL
- Union-find with path compression for near-duplicate grouping
- Central shortcut registry pattern (all shortcuts as data)
- Auto-computed triage labels ephemeral (computed on GET); overrides persist in annotation_triage table
- Switched AI agent from OpenAI GPT-4o to Google Gemini 2.0 Flash
- Pre-compute all data for AI agent prompt (no tool calls needed)

**Issues Resolved:**

- opencv-python-headless for Docker slim images (no X11 libs needed)
- DuckDB WAL stale file recovery via CHECKPOINT on shutdown
- PyTorch CPU install order (uv sync first, then replace with CPU wheel)
- Pydantic AI request_limit exceeded by Gemini tool-call loop (eliminated tools)
- GEMINI_API_KEY not loading (load_dotenv for third-party libs)
- pyvips missing for Moondream2 auto-tag (added dependency)

**Issues Deferred:**

- UMAP blocked by Python 3.14 numba incompatibility (using t-SNE)
- Moondream2 trust_remote_code fragile with transformers updates

**Technical Debt Incurred:**

- Module-level cache for Intelligence panel results (should use React Query cache)
- Old triage tags filtered client-side (OBSOLETE_TRIAGE_TAGS set in grid-cell.tsx)

---

_For current project status, see .planning/ROADMAP.md_
