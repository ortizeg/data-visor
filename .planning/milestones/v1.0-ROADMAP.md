# Milestone v1.0: VisionLens MVP

**Status:** SHIPPED 2026-02-12
**Phases:** 1-7
**Total Plans:** 21

## Overview

VisionLens replaces scattered CV scripts with a unified dataset introspection tool. The roadmap moved from data foundation (DuckDB + streaming ingestion) through visual browsing and filtering, then branched into parallel tracks for model predictions and embedding visualization, before converging on error analysis and the novel AI agent layer. Seven phases delivered all 26 v1 requirements, with Phases 4 and 5 executed in parallel.

## Phases

### Phase 1: Data Foundation

**Goal**: Users can load a COCO dataset from local disk or GCS and have all metadata queryable in DuckDB with cached thumbnails ready for display
**Depends on**: Nothing (first phase)
**Requirements**: INGEST-01, INGEST-02, INGEST-03, INGEST-04, INGEST-05, PLUGIN-01
**Plans**: 4 plans

Plans:
- [x] 01-01: Project scaffolding, DuckDB schema, config, Pydantic models, test infrastructure
- [x] 01-02: BasePlugin ABC, PluginRegistry, hook system, example plugin
- [x] 01-03: Storage abstraction (fsspec), streaming COCO parser (ijson), thumbnail service
- [x] 01-04: Ingestion pipeline, API routers (datasets, samples, images), SSE progress

**Completed:** 2026-02-11

### Phase 2: Visual Grid

**Goal**: Users can visually browse 100K+ images in a performant grid with bounding box annotations overlaid on each thumbnail
**Depends on**: Phase 1
**Requirements**: GRID-01, GRID-02, GRID-04, GRID-05
**Plans**: 3 plans

Plans:
- [x] 02-01: Next.js scaffolding, TanStack Virtual grid, infinite scroll with paginated API fetching
- [x] 02-02: SVG annotation overlays with deterministic color hashing, batch annotation endpoint
- [x] 02-03: Sample detail modal with full-resolution image, metadata display, and annotation list

**Completed:** 2026-02-11

### Phase 3: Filtering & Search

**Goal**: Users can slice the dataset by any metadata field, search by filename, tag samples, and save filter configurations for reuse
**Depends on**: Phase 2
**Requirements**: FILT-01, FILT-02, FILT-03, FILT-04
**Plans**: 2 plans

Plans:
- [x] 03-01: Backend filter builder + schema migration + facets endpoint; frontend filter sidebar with category/split filtering and Zustand store
- [x] 03-02: Search/sort, saved views CRUD, bulk tagging endpoints and UI

**Completed:** 2026-02-11

### Phase 4: Predictions & Comparison

**Goal**: Users can import model predictions and visually compare them against ground truth annotations with dataset-level statistics
**Depends on**: Phase 2 (annotation rendering)
**Requirements**: EVAL-01, GRID-03, EVAL-03
**Parallel with**: Phase 5 (independent)
**Plans**: 3 plans

Plans:
- [x] 04-01: Streaming prediction parser (COCO results format), import endpoint, prediction_count column
- [x] 04-02: GT vs Predictions overlay toggle (solid vs dashed SVG), source filter on batch annotations
- [x] 04-03: Dataset statistics dashboard (Recharts bar charts, summary cards, Grid/Statistics tab system)

**Completed:** 2026-02-11

### Phase 5: Embeddings & Visualization

**Goal**: Users can generate image embeddings and explore their dataset as a 2D scatter plot with interactive lasso selection that filters the grid
**Depends on**: Phase 1 (data layer, Qdrant)
**Requirements**: EMBED-01, EMBED-02, EMBED-03, EMBED-04
**Parallel with**: Phase 4 (independent)
**Plans**: 4 plans

Plans:
- [x] 05-01: DINOv2 embedding generation pipeline, DuckDB FLOAT[768] storage, SSE progress, background task
- [x] 05-02: t-SNE dimensionality reduction, 2D coordinate storage, SSE progress, coordinates API
- [x] 05-03: deck.gl scatter plot (OrthographicView + ScatterplotLayer), hover thumbnails, Embeddings tab
- [x] 05-04: SVG lasso selection, robust-point-in-polygon hit testing, cross-filter to grid via Zustand

**Completed:** 2026-02-12

### Phase 6: Error Analysis & Similarity

**Goal**: Users can categorize prediction errors and find visually similar images to any sample in the dataset
**Depends on**: Phase 4 (predictions), Phase 5 (embeddings + Qdrant)
**Requirements**: EVAL-02, AGENT-03
**Plans**: 2 plans

Plans:
- [x] 06-01: Error categorization service (TP/FP/FN/LE matching) + Error Analysis sub-tab in statistics dashboard
- [x] 06-02: Qdrant similarity service (local mode) + "Find Similar" button in SampleModal

**Completed:** 2026-02-11

### Phase 7: Intelligence & Agents

**Goal**: An AI agent automatically detects patterns in prediction errors and recommends corrective actions, while VLM auto-tagging enriches sample metadata
**Depends on**: Phase 6 (error categories, similarity search)
**Requirements**: AGENT-01, AGENT-02, AGENT-04
**Plans**: 3 plans

Plans:
- [x] 07-01: Pydantic AI agent service with DuckDB query tools, agent models, /analyze endpoint, config + infrastructure
- [x] 07-02: VLM auto-tagging pipeline (Moondream2 via transformers), background task with SSE progress, Auto-Tag button
- [x] 07-03: Agent analysis frontend: Intelligence sub-tab in Statistics dashboard, pattern + recommendation display

**Completed:** 2026-02-12

---

## Milestone Summary

**Key Decisions:**
- DuckDB over SQLite for analytical queries on 100K+ metadata rows (columnar storage)
- Qdrant over FAISS for payload filtering and local Rust-based deployment
- deck.gl with OrthographicView for WebGL-powered 2D embedding scatter
- Pydantic AI for type-safe agent definitions with native FastAPI integration
- Deterministic color hashing (HSL with constrained saturation/lightness)
- Plugin hooks architecture for extensibility without forking
- Source discriminator column for clean GT/prediction separation
- Lasso selection in embedding-store (not filter-store) for spatial vs metadata separation
- Lazy loading for Qdrant, VLM model, and AI agent (on-demand, not at startup)
- scikit-learn t-SNE over umap-learn due to Python 3.14 numba incompatibility

**Issues Resolved:**
- Moondream2 transformers 5.x compatibility (all_tied_weights_keys patch)
- MPS device auto-detection for Apple Silicon VLM inference
- Missing einops dependency for Moondream2
- libvips native dependency for Moondream2 image processing
- accelerate dependency for transformers device_map support

**Issues Deferred:**
- YOLO format parser (v2 — INGEST-06)
- Pascal VOC format parser (v2 — INGEST-07)
- In-tool model inference (v2 — EVAL-04)
- Plugin ingestion/UI/transformation hooks (v2 — PLUGIN-02/03/04)

**Technical Debt Incurred:**
- Phase 2 visual/UX items need manual verification (scrolling 100K+, bbox alignment, color consistency)
- umap-learn blocked by Python 3.14; using t-SNE as fallback

---

_Archived: 2026-02-12 as part of v1.0 milestone completion_
_For current project status, see .planning/ROADMAP.md_
